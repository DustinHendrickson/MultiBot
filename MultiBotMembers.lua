MultiBot.newMembers = function(pParent, pX, pY, pSize)	local frame = CreateFrame("Frame", nil, pParent)	frame.members = {}	frame.classes = {}	frame.index = {}		frame.button = nil	frame.select = nil	frame.browse = nil		frame.parent = pParent	frame.size = pSize		frame:SetPoint("BOTTOMRIGHT", pX, pY)	frame:SetSize(pSize, pSize)	frame:Show()		-- ADD --		frame.addMember = function(pName, pClass, pIndex)		if(frame.members[pName] == nil) then frame.members[pName] = MultiBot.newMember(frame, pName, pClass, 0, (frame.size + 2) * pIndex, frame.size) end		return frame.members[pName]	end		-- SET --		frame.setButton = function(pConfig, pStrate)		if(frame.button ~= nil) then frame.button:Hide() end		frame.button = MultiBot.newDouble(frame, 0, 0, pConfig, pStrate)		return frame.button	end		frame.setState = function(pState)		frame.button.setState(pState)	end		frame.setMembers = function()		local tIndex = 0		local tPos = 0				-- Supportet limit of Members is 50, because GetNumGuildMembers() only gives the Number of online Members		frame.limit = 50		frame.from = 1		frame.to = 10				for i = 1, frame.limit do			local tName, tRank, tGuildIndex, tLevel, tClass = GetGuildRosterInfo(i)						-- Ensure that Index is not bigger than the Amount of Members in Guildlist			if(tName ~= nil and tLevel ~= nil and tClass ~= nil) then				local tBot = MultiBot.getBot(tName)								-- Ensure that Memberbot is not a Playerbot				if(tBot == nil and tName ~= UnitName("player")) then					local tTemp = string.sub(string.lower(tClass), 1, 1) .. string.sub(string.lower(tClass), 4, 4)					tIndex = tIndex + 1										-- Mapping German and English localisation of Classes					if(tTemp == "di") then tClass = "Druid" end					if(tTemp == "he" or tTemp == "wl") then tClass = "Warlock" end					if(tTemp == "jg" or tTemp == "ht") then tClass = "Hunter" end					if(tTemp == "ke" or tTemp == "wr") then tClass = "Warrior" end					if(tTemp == "mi" or tTemp == "me") then tClass = "Mage" end					if(tTemp == "pa") then tClass = "Paladin" end					if(tTemp == "pe") then tClass = "Priest" end					if(tTemp == "sa" or tTemp == "sm") then tClass = "Shaman" end					if(tTemp == "su" or tTemp == "ru") then tClass = "Rogue" end					if(tTemp == "te" or tTemp == "dt") then tClass = "DeathKnight" end										if(frame.classes[string.lower(tClass)] == nil) then frame.classes[string.lower(tClass)] = {} end					table.insert(frame.classes[string.lower(tClass)], tName)					frame.index[tIndex] = tName					tPos = (tIndex - 1)%10 + 1										local tMember = frame.addMember(tName, tClass, tPos)					tMember.setButton({						"TOGGLE:MEMBERS",						tName,						"Interface\\AddOns\\MultiBot\\Icons\\class_" .. strlower(tClass) .. ".blp",						".playerbot bot remove " .. tName,						".playerbot bot add " .. tName,						"Left to show or hide Options | Right to logout " .. tName,						tClass .. " - " .. tLevel .. " - " .. tName,						tName					})										if(tIndex > 10)					then tMember:Hide()					else tMember:Show()					end				end			else				frame.limit = tIndex				break			end		end				-- FILTER --				if(frame.limit > 10) then			frame.select = MultiBot.newSelect(frame, 0, (frame.size + 2) * 11, MultiBot.config.members.filter, true).addOptions("none")			frame.browse = MultiBot.newSingle(frame, 0, (frame.size + 2) * 12, MultiBot.config.members.browse)		else			frame.select = MultiBot.newSelect(frame, 0, (frame.size + 2) * (tIndex + 1), MultiBot.config.members.filter, true).addOptions("none")			frame.browse = MultiBot.newSingle(frame, 0, (frame.size + 2) * (tIndex + 2), MultiBot.config.members.browse)			frame.browse:Hide()		end				frame.doHide()		return frame	end		-- GET --		frame.getBotByIndex = function(pIndex)		if(frame.index[pIndex] == nil) then return nil end		return frame.members[frame.index[pIndex]]	end		frame.getBotByName = function(pName)		return frame.members[pName]	end		-- DO --		frame.doBrowse = function(pLimit)		if(pLimit ~= nil) then frame.limit = pLimit end				local tFilter = frame.select.action[7]		local tMember = nil		local tTable = nil		local tIndex = 0				if(tFilter ~= "none")		then tTable = frame.classes[tFilter]		else tTable = frame.index		end				for key, value in pairs(frame.members) do value:Hide() end				if(tTable == nil) then			frame.select.setPoint(0, (frame.size + 2) * 1)			frame.browse.setPoint(0, (frame.size + 2) * 2)			frame.browse:Hide()			return		end				if(frame.limit == 0) then			frame.limit = table.getn(tTable)			frame.from = 1			frame.to = 10						for i = 1, frame.limit do				tIndex = (i - 1)%10 + 1				tMember = frame.members[tTable[i]]				tMember.setPoint(0, (frame.size + 2) * tIndex)				if(frame.from <= i and frame.to >= i)				then tMember:Show()				else tMember:Hide()				end			end						if(frame.limit < frame.to) then				frame.select.setPoint(0, (frame.size + 2) * (frame.limit + 1))				frame.browse.setPoint(0, (frame.size + 2) * (frame.limit + 2))			else				frame.select.setPoint(0, (frame.size + 2) * (frame.to + 1))				frame.browse.setPoint(0, (frame.size + 2) * (frame.to + 2))			end						if(frame.limit < 10) then				frame.browse:Hide()			else				frame.browse:Show()			end		else			local tFrom = frame.from + 10			local tTo = frame.to + 10						if(tFrom > frame.limit) then				tFrom = 1				tTo = 10			end						if(tTo > frame.limit) then				tTo = frame.limit			end						for i = 1, frame.limit do				tMember = frame.members[tTable[i]]								if(frame.from <= i and frame.to >= i) then					tMember:Hide()				end								if(tFrom <= i and tTo >= i) then					tIndex = tIndex + 1					tMember:Show()				end			end						frame.from = tFrom			frame.to = tTo						frame.select.setPoint(0, (frame.size + 2) * (tIndex + 1))			frame.browse.setPoint(0, (frame.size + 2) * (tIndex + 2))		end	end		frame.doCloseInventories = function(pName)		for key, value in pairs(frame.members) do			if(value.name ~= pName and value.button.state == true) then				value.right.buttons["inventory"].setState(false)				value.inventory.doClose()			end		end	end		frame.doSummon = function()		for key, value in pairs(frame.members) do			if(value.button.state == true) then				SendChatMessage("summon", "WHISPER", nil, key)			end		end	end		frame.doRefresh = function()		frame.doHide()		table.wipe(frame.members)		table.wipe(frame.classes)		table.wipe(frame.index)		frame.setMembers()		MultiBot.doShow("MEMBERS")	end		frame.doHide = function()		for key, value in pairs(frame.members) do value:Hide() end		frame.browse:Hide()		frame.select:Hide()	end		frame.doShow = function()		local tFilter = frame.select.action[7]		local tTable = nil				if(tFilter ~= "none")		then tTable = frame.classes[frame.select.action[7]]		else tTable = frame.index		end				for i = 1, table.getn(tTable) do			if(frame.from <= i and frame.to >= i)			then frame.members[tTable[i]]:Show()			else frame.members[tTable[i]]:Hide()			end		end				if(frame.limit > 10) then frame.browse:Show() end		frame.select:Show()	end		return frame.setMembers()endprint("AfterMultiBotMembers")